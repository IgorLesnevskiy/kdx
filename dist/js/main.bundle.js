!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=1)}([function(t,e,r){"use strict";var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return n(t,null,[{key:"cloneObject",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return JSON.parse(JSON.stringify(t))}},{key:"formatMoney",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ru",r=Number(t);return isNaN(r)?t:r.toLocaleString(e)}},{key:"getPriceWithTax",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:13,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=Number(t),i=Number(e);if(isNaN(n)||isNaN(i))return t;var a=n*i/100+n;return a%1==0?a:a.toFixed(r)}}]),t}();t.exports=i},function(t,e,r){"use strict";(function(t){var e=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var n=r(3),i=r(0),a=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cCarambaController=new n,this.cTools=new i}return e(t,[{key:"init",value:function(){var t=this;return Promise.resolve().then(function(){return t.cCarambaController.init()})}}]),t}());$(document).ready(function(){a.init().then(function(){t.AC=a})})}).call(this,r(2))},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var i=r(0),a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.loadUrl="https://rawgit.com/Varinetz/e6cbadec972e76a340c41a65fcc2a6b3/raw/90191826a3bac2ff0761040ed1d95c59f14eaf26/frontend_test_table.json",this.text={ru:{"status--pending":"Ожидается","status--out_of_stock":"Нет в наличии","status--in_stock":"В наличии","error--load_error":"Ошибка загрузки данных","error--empty_data":"Нет данных для отображения",remove_button_text:"Удалить",currency:"руб."},en:{}},this.locale="ru",this.tax=13,this.getText=this.getTextByLocale(this.locale),this.markupTemplate={scaffold:'\n\t\t\t\t<div class="b-custom-table__row" data-row-id="{{id}}">\n\t\t\t\t  <div class="b-custom-table__cell b-custom-table__cell--title">\n\t\t\t\t    <div class="title">{{title}}</div>\n\t\t\t\t    {{optionalDescription}}\n\t\t\t\t  </div>\n\t\t\t\t  <div class="b-custom-table__cell b-custom-table__cell--year">{{year}}</div>\n\t\t\t\t  <div class="b-custom-table__cell b-custom-table__cell--color">\n\t\t\t\t    {{optionalColorbox}}\n\t\t\t\t  </div>\n\t\t\t\t  <div class="b-custom-table__cell b-custom-table__cell--status">{{status}}</div>\n\t\t\t\t  <div class="b-custom-table__cell b-custom-table__cell--price">\n\t\t\t\t    <nobr class="price js-price" data-original-price="{{price}}">{{formattedPrice}}</nobr>\n\t\t\t\t    <nobr class="price-with-tax js-price-with-tax" data-original-price-with-tax="{{priceWithTax}}">{{formattedPriceWithTax}} (+13%)</nobr>\n\t\t\t\t  </div>\n\t\t\t\t  <div class="b-custom-table__cell b-custom-table__cell--action">\n\t\t\t\t    <button class="i-button i-button--ellipse i-button--size-small js-delete-trigger">{{removeButtonText}}</button>\n\t\t\t\t  </div>\n\t\t\t\t</div>\n\t\t\t',optional:{description:'<div class="description">{{description}}</div>',colorBox:'<div class="i-color-box" style="background-color: {{colorCode}}"></div>'}},this.$tableWrapper=null}return n(t,[{key:"init",value:function(){var t=this;this.$tableWrapper=$("#caramba-table"),this.$tableWrapper.length&&(this.$tableRowContainer=this.$tableWrapper.find(".js-body"),this.$tableNoty=this.$tableWrapper.find(".js-noty"),this.$tableSummaryPrice=this.$tableWrapper.find(".js-summary-price"),this.initDeleteTrigger(),this.lockTable(),this.loadData().then(function(e){return Promise.resolve().delay(1e3).then(function(){Object.keys(e).length?t.updateTableWithData(e):t.showTableNotification(t.getText("error--empty_data"))})}).then(function(){t.unlockTable()}).catch(function(e){t.showTableNotification(t.getText("error--load_error"))}))}},{key:"loadData",value:function(){var t=this;return new Promise(function(e,r){$.ajax({url:t.loadUrl,data:{},dataType:"json",success:function(t){e(t)},error:function(t,e,n){r("false")}})})}},{key:"lockTable",value:function(){}},{key:"updateTableWithData",value:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var e=[];for(var r in t)if(t.hasOwnProperty(r)&&t[r].id&&t[r].title){var n=this.markupTemplate.scaffold;for(var a in t[r])if(t[r].hasOwnProperty(a)){var o=t[r][a];if("id"==a&&(n=n.replace(/{{id}}/g,o)),"title"==a&&(n=n.replace(/{{title}}/g,o)),"description"==a&&(n=(n=n.replace(/{{optionalDescription}}/g,this.markupTemplate.optional.description)).replace(/{{description}}/g,o)),"color"==a&&(n=(n=n.replace(/{{optionalColorbox}}/g,this.markupTemplate.optional.colorBox)).replace(/{{colorCode}}/g,o)),"year"==a&&(n=n.replace(/{{year}}/g,o)),"status"==a){"pednding"==o&&(o="pending");var l=this.getText("status--"+o);n=n.replace(/{{status}}/g,l||"-")}if("price"==a){var c=o,s=i.getPriceWithTax(o,this.tax),u=i.formatMoney(o,this.locale),f=i.formatMoney(i.getPriceWithTax(o,this.tax),this.locale);n=(n=(n=(n=n.replace(/{{price}}/g,c)).replace(/{{formattedPrice}}/g,u+" "+this.getText("currency"))).replace(/{{priceWithTax}}/g,s)).replace(/{{formattedPriceWithTax}}/g,f+" "+this.getText("currency"))}}n=n.replace(/{{optionalDescription}}/g,"").replace(/{{optionalColorbox}}/g,"").replace(/{{removeButtonText}}/g,this.getText("remove_button_text")),e.push(n)}this.$tableRowContainer.append(e.join("")),this.updateSummaryPrice()}},{key:"updateSummaryPrice",value:function(){var t=0;$.each(this.getRows(),function(e,r){var n=$(r),i=n.find(".js-price-with-tax").length?n.find(".js-price-with-tax").attr("data-original-price-with-tax"):n.find(".js-price").attr("data-original-price");i&&(t=Number(t)+Number(i))}),this.$tableSummaryPrice.html(i.formatMoney(Number(t),this.locale)+" "+this.getText("currency"))}},{key:"getRows",value:function(){return this.$tableRowContainer.find("[data-row-id]")}},{key:"getTextByLocale",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ru";arguments[1];return function(r){return!!(t.text&&t.text[e]&&t.text[e][r])&&t.text[e][r]}}},{key:"lockTable",value:function(){this.$tableWrapper.addClass("is-preloading")}},{key:"unlockTable",value:function(){this.$tableWrapper.removeClass("is-preloading")}},{key:"isTableLock",value:function(){}},{key:"showTableNotification",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t&&(this.$tableNoty.html(t),this.$tableWrapper.addClass("is-noty"))}},{key:"isNoRows",value:function(){return 0==this.getRows().length}},{key:"initDeleteTrigger",value:function(){var t=this;this.$tableWrapper.on("click",".js-delete-trigger",function(e){var r=$(e.currentTarget).closest("[data-row-id]");r.length&&(t.lockTable(),Promise.resolve().delay(100).then(function(){r.remove(),t.isNoRows()&&t.showTableNotification(t.getText("error--empty_data")),t.updateSummaryPrice(),t.unlockTable()}))})}}]),t}();t.exports=a}]);